<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:title" content="Programação Agosto 2025" />
  <meta property="og:description" content="Verifique nossa programação para Agosto de 2025" />
  <meta property="og:image" content="https://stock.adobe.com/images/green-leaves-blurred-background-nature-banner-hd/885917111" />
  <meta property="og:url" content="https://rabriol.github.io/orangevale_newsletter/index.html" />
  <meta property="og:type" content="website" />

  <title>Programação de Agosto 2025</title>

  <style>
    /* ... original styles preserved ... */
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
    }

    .calendar {
      max-width: 400px;
      width: 100%;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .calendar-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-bottom: 15px;
    }

    .logo {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      overflow: hidden;
      background: #e0e0e0;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 10px;
    }

    .logo img {
      width: 100%;
      height: auto;
    }

    .calendar-header h1 {
      font-size: 20px;
      margin: 0;
      font-weight: bold;
    }

    .agenda-title {
      font-size: 14px;
      color: #666;
      margin-top: 5px;
    }

    .nav-buttons {
      display: flex;
      justify-content: space-between;
      margin: 15px 0;
      gap: 10px;
    }

    .nav-buttons button {
      flex: 1;
      padding: 8px;
      font-weight: bold;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background-color: #4caf50;
      color: white;
      transition: background 0.3s ease;
    }

    .nav-buttons button:hover {
      background-color: #388e3c;
    }

    .nav-buttons button.disabled {
      background-color: #ccc;
      color: #777;
      pointer-events: none;
      cursor: not-allowed;
    }

    .slider-wrapper {
      overflow: hidden;
    }

    .calendar-slider {
      display: flex;
      transition: transform 0.4s ease;
      width: 100%;
    }

    .month {
      width: 100%;
      flex-shrink: 0;
    }

    .day {
      display: flex;
      align-items: flex-start;
      padding: 10px 0;
      border-bottom: 1px solid #ddd;
    }

    .date {
      min-width: 80px;
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      color: #333;
      margin-right: 15px;
      flex-shrink: 0;
    }

    .weekday {
      display: block;
      font-size: 12px;
      color: #666;
    }

    .events {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .event {
      padding: 10px;
      border-radius: 5px;
      font-size: 14px;
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .event.lunch { background: #5672f9; }
    .event.trip { background: #f2b84b; color: #333; }
    .event.meeting { background: #4caf50; }
    .event.conference { background: #ff7043; }
    .event.party { background: #9c27b0; }
    .event.workshop { background: #009688; }

    .event-time { font-size: 12px; opacity: 0.8; }
    .event-title { font-size: 16px; font-weight: bold; }
    .event-location { font-size: 14px; opacity: 0.9; }

    .event-details {
      max-height: 0;
      overflow: hidden;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 5px;
      margin-top: 5px;
      padding: 0;
      color: #333;
      transition: max-height 0.3s ease, padding 0.3s ease;
    }

    .event-details.open {
      max-height: 900px;
      padding: 10px;
    }

    .event-details p {
      margin: 5px 0;
      font-size: 12px;
    }

    .event-image {
      width: 100%;
      max-height: 400px;
      object-fit: cover;
      border-radius: 5px;
      margin-bottom: 10px;
    }

    .postponed-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 20px;
      font-weight: bold;
      color: red;
      background: rgba(255, 255, 255, 0.6);
      padding: 8px 15px;
      border-radius: 5px;
      text-transform: uppercase;
    }

    .past-event {
      opacity: 0.5;
      filter: grayscale(50%);
    }

    .event.postponed {
      position: relative;
      opacity: 0.7;
    }
  </style>
</head>

<body>
  <div class="calendar">
    <div class="calendar-header">
      <div class="logo">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRrKMuP3nKZW4XGVQZpL0SYXY39wrY_ikte2g&s" alt="Church Logo" />
      </div>
      <h1>SDARM Orangevale Church</h1>
      <p class="agenda-title" id="agenda-title">Agenda Agosto 2025</p>
    </div>

    <div class="nav-buttons">
      <button id="prev-month">← Mês anterior</button>
      <button id="next-month">Próximo mês →</button>
    </div>

    <div class="slider-wrapper">
      <div class="calendar-slider" id="calendar-slider">
        <div class="month" id="calendar-march"></div>
        <div class="month" id="calendar-april"></div>
        <div class="month" id="calendar-may"></div>
        <div class="month" id="calendar-june"></div>
        <div class="month" id="calendar-july"></div>
        <div class="month" id="calendar-august"></div>
        <div class="month" id="calendar-september"></div>
        <div class="month" id="calendar-october"></div>
      </div>
    </div>
  </div>

  <!-- Load Google Visualization API -->
  <script src="https://www.gstatic.com/charts/loader.js"></script>

  <script>
    const months = [
      { name: 'Março', sheetName: 'march', data: {}, elementId: 'calendar-march', monthIndex: 2 },
      { name: 'Abril', sheetName: 'april', data: {}, elementId: 'calendar-april', monthIndex: 3 },
      { name: 'Maio', sheetName: 'may', data: {}, elementId: 'calendar-may', monthIndex: 4 },
      { name: 'Junho', sheetName: 'june', data: {}, elementId: 'calendar-june', monthIndex: 5 },
      { name: 'Julho', sheetName: 'july', data: {}, elementId: 'calendar-july', monthIndex: 6 },
      { name: 'Agosto', sheetName: 'august', data: {}, elementId: 'calendar-august', monthIndex: 7 },
      { name: 'Setembro', sheetName: 'september', data: {}, elementId: 'calendar-september', monthIndex: 8 },
      { name: 'Outubro', sheetName: 'october', data: {}, elementId: 'calendar-october', monthIndex: 9 }
    ]

    function getCurrentMonthIndex() {
      const now = new Date()
      const currentMonth = now.getMonth() // 0-indexed: Jan = 0, Mar = 2, etc.
      return months.findIndex(m => m.monthIndex === currentMonth)
    }

    const slider = document.getElementById("calendar-slider")
    const agendaTitle = document.getElementById("agenda-title")
    const prevBtn = document.getElementById("prev-month")
    const nextBtn = document.getElementById("next-month")
    let currentIndex = getCurrentMonthIndex()
    if (currentIndex === -1) currentIndex = 0 // fallback to first month if not found

    function renderEvents(events, container, monthIndex) {
      container.innerHTML = ""
      const weekdays = ["Domingo", "Segunda-Feira", "Terça-Feira", "Quarta-Feira", "Quinta-Feira", "Sexta-Feira", "Sábado"]

      Object.keys(events).forEach(day => {
        const date = new Date(2025, monthIndex, day)
        const weekday = weekdays[date.getDay()]
        const dayDiv = document.createElement("div")
        dayDiv.classList.add("day")

        const dateDiv = document.createElement("div")
        dateDiv.classList.add("date")
        dateDiv.innerHTML = `${String(day).padStart(2, "0")}<br><span class="weekday">${weekday}</span>`

        const eventsDiv = document.createElement("div")
        eventsDiv.classList.add("events")

        events[day].forEach(event => {
          const eventDiv = document.createElement("div")
          eventDiv.classList.add("event", event.type)

          if (event.time && isPastEvent(event.time, parseInt(day), monthIndex)) {
            eventDiv.classList.add("past-event")
          }

          if (event.postponed) {
            eventDiv.classList.add("postponed")
            eventDiv.innerHTML += `<div class="postponed-overlay">${event.cause || 'Adiado'}</div>`
          }

          eventDiv.innerHTML += `
            <div class="event-time">${event.time}</div>
            <div class="event-title">${event.title}</div>
            <div class="event-location">${event.location}</div>
          `

          const detailsDiv = document.createElement("div")
          detailsDiv.classList.add("event-details")

          if (event.image) {
            const img = document.createElement("img")
            img.src = event.image
            img.alt = event.title
            img.classList.add("event-image")
            detailsDiv.appendChild(img)
          }

          if (event.organizer)
            detailsDiv.innerHTML += `<p><strong>Organizador:</strong> ${event.organizer}</p>`
          if (event.description)
            detailsDiv.innerHTML += `<p><strong>Descrição:</strong> ${event.description}</p>`
          if (event.location)
            detailsDiv.innerHTML += `<p><strong>Local:</strong> 
              <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(event.location)}" target="_blank">${event.location}</a>
            </p>`
          if (event.phone)
            detailsDiv.innerHTML += `<p><strong>Contato:</strong> ${event.phone}</p>`
          if (event.notes)
            detailsDiv.innerHTML += `<p><strong>Programação:</strong> ${event.notes}</p>`

          eventDiv.appendChild(detailsDiv)
          eventDiv.addEventListener("click", () => detailsDiv.classList.toggle("open"))
          eventsDiv.appendChild(eventDiv)
        })

        dayDiv.appendChild(dateDiv)
        dayDiv.appendChild(eventsDiv)
        container.appendChild(dayDiv)
      })
    }

    function isPastEvent(time, eventDay, eventMonthIndex) {
      const now = new Date()
      const eventDate = new Date(2025, eventMonthIndex, eventDay)

      const [, end] = time.split(" - ")
      if (!end) return false

      const [h, m] = end.split(":").map(Number)
      eventDate.setHours(h, m, 0, 0)

      return eventDate < now
    }

    function updateUI() {
      agendaTitle.textContent = `Agenda ${months[currentIndex].name} 2025`
      slider.style.transform = `translateX(-${currentIndex * 100}%)`
      prevBtn.classList.toggle("disabled", currentIndex === 0)
      nextBtn.classList.toggle("disabled", currentIndex === months.length - 1)
    }

    prevBtn.addEventListener("click", () => {
      if (currentIndex > 0) {
        currentIndex--
        updateUI()
      }
    })

    nextBtn.addEventListener("click", () => {
      if (currentIndex < months.length - 1) {
        currentIndex++
        updateUI()
      }
    })

    // Load from Google Sheets
    google.charts.load('current', { packages: ['corechart'] })
    google.charts.setOnLoadCallback(loadAllSheets)

    function loadAllSheets() {
        let loadedCount = 0

        months.forEach((month, index) => {
          const query = new google.visualization.Query(
            `https://docs.google.com/spreadsheets/d/1t5quktGOv-JIhfaYFPYoBq5U1vLF53MpF-lSDU4ALQs/gviz/tq?sheet=${encodeURIComponent(month.sheetName)}`
          )

          query.send(response => {
            if (response.isError()) {
              console.error(`Erro ao carregar a planilha ${month.sheetName}:`, response.getMessage())
              return
            }

            const data = response.getDataTable()
            const rows = data.getNumberOfRows()
            const monthData = {}

            for (let i = 0; i < rows; i++) {
              const dayRaw = data.getValue(i, 0)
              if (dayRaw == null || isNaN(dayRaw)) continue

              const day = parseInt(dayRaw)
              if (!monthData[day]) monthData[day] = []

              monthData[day].push({
                time: data.getValue(i, 2) || '',
                title: data.getValue(i, 3) || '',
                location: data.getValue(i, 4) || '',
                type: data.getValue(i, 5) || '',
                description: data.getValue(i, 6) || '',
                organizer: data.getValue(i, 7) || '',
                notes: data.getValue(i, 8) || '',
                postponed: data.getValue(i, 9)?.toString().toLowerCase() === 'true',
                cause: data.getValue(i, 10) || '',
                phone: data.getValue(i, 11) || '',
                image: data.getValue(i, 12) || ''
              })
            }

            months[index].data = monthData
            const container = document.getElementById(month.elementId)
            renderEvents(monthData, container, month.monthIndex)

            loadedCount++
            if (loadedCount === months.length) {
              updateUI()
            }
          })
        })
      }
  </script>
</body>

</html>
